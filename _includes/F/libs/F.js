// Generated by CoffeeScript 1.4.0
(function() {

  $(document).ready(function() {
    var navbar, scrollspybar, ssheight, ssjson, sstpl;
    if ($.cookie('oauth-token')) {
      $('#backend').addClass('show');
    }
    navbar = $(".F-main-navbar-");
    navbar.css("height", navbar.height());
    navbar.children(".F-main-navbar").affix({
      offset: {
        top: navbar.offset().top
      }
    });
    sstpl = '<div class="nav">\n	<div class="f-block">\n		<ul>\n		{{#items}}\n			<li>\n				<a href="#{{id}}">{{content}}</a>\n			</li>\n		{{/items}}\n		</ul>\n	</div>\n</div>';
    ssjson = {
      items: []
    };
    $("article [id]").each(function(i, item) {
      return ssjson.items.push({
        id: $(item).attr("id"),
        content: $(item).text()
      });
    });
    scrollspybar = $("#book_bar");
    if (scrollspybar.length > 0) {
      scrollspybar.html(Mustache.render(sstpl, ssjson));
      scrollspybar.children(".nav").css("padding-top", navbar.height());
      scrollspybar.css("margin-top", "-" + (navbar.height()));
      ssheight = scrollspybar.height() + 10;
      scrollspybar.css("height", ssheight);
      $('body').scrollspy($.extend({}, $('body').data(), {
        offset: ssheight
      }));
      scrollspybar.find("li > a").click(function(event) {
        event.preventDefault();
        return $('body').scrollTop($("#" + ($(this).attr('href').replace(/^#/, ''))).offset().top - ssheight);
      });
      return scrollspybar.children(".nav").affix({
        offset: {
          top: scrollspybar.offset().top
        }
      });
    }
  });

}).call(this);
