// Generated by CoffeeScript 1.3.3
(function() {

  requirejs(["jquery", "mustache", "bootstrap-affix", "bootstrap-dropdown", "bootstrap-scrollspy"], function() {
    return $(document).ready(function() {
      var navbar, scrollspybar, ssheight, ssjson, sstpl;
      navbar = $(".F-main-navbar-");
      navbar.css("height", navbar.height());
      navbar.children(".F-main-navbar").affix({
        offset: {
          top: navbar.offset().top
        }
      });
      sstpl = '<div class="nav">\n	<div class="f-block">\n		<ul>\n		{{#items}}\n			<li>\n				<a href="#{{id}}">{{content}}</a>\n			</li>\n		{{/items}}\n		</ul>\n	</div>\n</div>';
      ssjson = {
        items: []
      };
      $("article [id]").each(function(i, item) {
        return ssjson.items.push({
          id: $(item).attr("id"),
          content: $(item).text()
        });
      });
      scrollspybar = $("#test_bar");
      if (scrollspybar.length > 0) {
        scrollspybar.html(Mustache.render(sstpl, ssjson));
        scrollspybar.children(".nav").css("padding-top", navbar.height());
        scrollspybar.css("margin-top", "-" + (navbar.height()));
        ssheight = scrollspybar.height() + 10;
        scrollspybar.css("height", ssheight);
        $('body').scrollspy($.extend({}, $('body').data(), {
          offset: ssheight
        }));
        $("#test_bar li > a").click(function(event) {
          event.preventDefault();
          return $('body').scrollTop($("#" + ($(this).attr('href').replace(/^#/, ''))).offset().top - ssheight);
        });
        return scrollspybar.children(".nav").affix({
          offset: {
            top: scrollspybar.offset().top
          }
        });
      }
    });
  });

}).call(this);
